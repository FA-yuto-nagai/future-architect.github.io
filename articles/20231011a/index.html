<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <!--
    ███████╗██╗░░░██╗████████╗██╗░░░██╗██████╗░███████╗
    ██╔════╝██║░░░██║╚══██╔══╝██║░░░██║██╔══██╗██╔════╝
    █████╗░░██║░░░██║░░░██║░░░██║░░░██║██████╔╝█████╗░░
    ██╔══╝░░██║░░░██║░░░██║░░░██║░░░██║██╔══██╗██╔══╝░░
    ██║░░░░░╚██████╔╝░░░██║░░░╚██████╔╝██║░░██║███████╗
    ╚═╝░░░░░░╚═════╝░░░░╚═╝░░░░╚═════╝░╚═╝░░╚═╝╚══════╝
    ████████╗███████╗░█████╗░██╗░░██╗
    ╚══██╔══╝██╔════╝██╔══██╗██║░░██║
    ░░░██║░░░█████╗░░██║░░╚═╝███████║
    ░░░██║░░░██╔══╝░░██║░░██╗██╔══██║
    ░░░██║░░░███████╗╚█████╔╝██║░░██║
    ░░░╚═╝░░░╚══════╝░╚════╝░╚═╝░░╚═╝
    ██████╗░██╗░░░░░░█████╗░░██████╗░
    ██╔══██╗██║░░░░░██╔══██╗██╔════╝░
    ██████╦╝██║░░░░░██║░░██║██║░░██╗░
    ██╔══██╗██║░░░░░██║░░██║██║░░╚██╗
    ██████╦╝███████╗╚█████╔╝╚██████╔╝
    ╚═════╝░╚══════╝░╚════╝░░╚═════╝░
    Welcome engineer.
    https://www.future.co.jp/recruit/
  -->
  
  <title>Prompt Flowをローカルで動かす＆コードで管理する | フューチャー技術ブログ</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  
  <meta name="description" content="はじめにこんにちは、SAIG&#x2F;MLOpsチームでアルバイトをしている板野です。 AzureのPrompt Flowをローカル環境で動かし、作成したフローをコードで管理する方法をご紹介します。 Prompt Flowとは、Azure Machine Learning上の機能で、Azure OpenAIで提供されているLLMを利用したアプリケーション開発を円滑にするためのツールです。 実際に">
<meta property="og:type" content="article">
<meta property="og:title" content="Prompt Flowをローカルで動かす＆コードで管理する | フューチャー技術ブログ">
<meta property="og:url" content="https://future-architect.github.io/articles/20231011a/index.html">
<meta property="og:site_name" content="フューチャー技術ブログ">
<meta property="og:description" content="はじめにこんにちは、SAIG&#x2F;MLOpsチームでアルバイトをしている板野です。 AzureのPrompt Flowをローカル環境で動かし、作成したフローをコードで管理する方法をご紹介します。 Prompt Flowとは、Azure Machine Learning上の機能で、Azure OpenAIで提供されているLLMを利用したアプリケーション開発を円滑にするためのツールです。 実際に">
<meta property="og:locale" content="ja_JP">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/image.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/image_2.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/コメント_2023-09-25_163948.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/pic.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/pic2.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/pic3.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/pic4.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/image_3.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/image_4.png">
<meta property="og:image" content="https://future-architect.github.io/images/20231011a/pic5.png">
<meta property="article:published_time" content="2023-10-10T15:00:00.000Z">
<meta property="article:modified_time" content="2024-02-20T05:41:28.763Z">
<meta property="article:tag" content="Azure">
<meta property="article:tag" content="LLM">
<meta property="article:tag" content="Prompt Flow">
<meta property="article:tag" content="AzureOpenAIService">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://future-architect.github.io/images/20231011a/image.png">
  
  <link rel="alternate" href="/atom.xml" title="フューチャー技術ブログ" type="application/atom+xml">
  
  <link rel="icon" href="/logo.svg" sizes="any" type="image/svg+xml">
  <link rel="mask-icon" href="/logo.svg" sizes="any" color="#0bd">
  <link rel="icon alternate" href="/favicon.ico">
  <link rel="apple-touch-icon" sizes='180x180' href="/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes='57x57' href="/apple-touch-icon-57x57.png">
  <link rel="canonical" href="https://future-architect.github.io/articles/20231011a/">
  <meta content="Azure,LLM,Prompt Flow,AzureOpenAIService" name="keywords">
  <meta content="板野竜也" name="author">
  <link rel="preload" as="image" href="/banner.jpg" />
  <link rel='manifest' href='/manifest.webmanifest'/>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <link rel="stylesheet" href="/metronic/assets/style.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
<meta name="generator" content="Hexo 5.4.2"></head>

<body class="corporate">
  <div class="wrap" itemscope itemtype="https://schema.org/TechArticle">
  <!-- BEGIN HEADER -->
<header class="header">
	<div class="header-overlay">
		<div class="header-menu"></div>
		<div class="header-title"><a href="/">Future Tech Blog</a></div>
		<div class="header-title-sub">フューチャー技術ブログ</div>
	</div>
</header>
<!-- Header END -->

  <div class="container">
  <ul class="breadcrumb">
    <li><a href="/">Home</a></li>
    <li><a href="/articles/">Blog</a></li>
    <li class="active">Post</li>
  </ul>
  <section id="main" class="margin-top-30">
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/DataScience/">DataScienceカテゴリ</a>
  </div>


    <h2 itemprop="name" class="article-title">Prompt Flowをローカルで動かす＆コードで管理する
  
  <a target="_blank" rel="noopener" href="https://github.com/future-architect/tech-blog/edit/master/source/_posts/2023/20231011a_Prompt_Flowをローカルで動かす＆コードで管理する.md" title="Suggest Edits" class="github-edit"><i class="github-edit-icon"></i></a>
  
</h2>

    <div class="row">
  <main class="col-md-9 blog-posts">
    <article id="post-2023/20231011a_Prompt_Flowをローカルで動かす＆コードで管理する" class="article article-type-post blog-item" itemscope itemprop="blogPost">
      <div class="article-inner">
        
        <header class="article-header">
          <ul class="blog-info">
            <li class="blog-info-item"><a href="/articles/2023/" class="publish-date"><time datetime="2023-10-10T15:00:00.000Z" itemprop="datePublished">2023.10.11</time></a>
</li>
            <li class="blog-info-item"><li><a href="/authors/%E6%9D%BF%E9%87%8E%E7%AB%9C%E4%B9%9F" title="板野竜也さんの記事一覧へ" class="post-author">板野竜也</a></li></li>
            <li class="blog-info-item">
  
    
    <a href="/tags/Azure/" title="Azureタグの記事へ" class="tag-list-link">Azure</a>
  
    
    <a href="/tags/LLM/" title="LLMタグの記事へ" class="tag-list-link">LLM</a>
  
    
    <a href="/tags/Prompt-Flow/" title="Prompt Flowタグの記事へ" class="tag-list-link">Prompt Flow</a>
  
    
    <a href="/tags/AzureOpenAIService/" title="AzureOpenAIServiceタグの記事へ" class="tag-list-link">AzureOpenAIService</a>
  

</li>
            <li class="blog-info-item">1,200 View</li>
          </ul>
          </header>
        
        <div class="article-entry" itemprop="articleBody">
          
            <h2 id="はじめに"><a href="#はじめに" class="headerlink" title="はじめに"></a>はじめに</h2><p>こんにちは、SAIG&#x2F;MLOpsチームでアルバイトをしている板野です。</p>
<p>AzureのPrompt Flowをローカル環境で動かし、作成したフローをコードで管理する方法をご紹介します。</p>
<p>Prompt Flowとは、Azure Machine Learning上の機能で、Azure OpenAIで提供されているLLMを利用したアプリケーション開発を円滑にするためのツールです。</p>
<p>実際にLLMアプリケーションを開発する場合、「プロンプトを入力して終わり」ではなく、ベクトル検索など複数の要素を組み合わせることもあります。このため、Prompt Flowでは処理のフローをDAG(有向非巡回グラフ)で可視化することで、開発効率が大きく向上します。</p>
<p>Prompt FlowはPython<a target="_blank" rel="noopener" href="https://github.com/microsoft/promptflow">ライブラリ</a>（2023&#x2F;09&#x2F;27時点ではMITライセンス）として提供されており、Azureのコンソール画面だけでなく、ローカル環境でも実行することができます。</p>
<p>ローカルで実行できることには以下の利点があります。</p>
<ul>
<li>特定のクラウドベンダーに依存しないので開発の選択肢が広がる</li>
<li>フローをコードで管理できる<ul>
<li>よくアップデートされるGUIの変化に戸惑う必要がない</li>
<li>コード編集の差分を記録できる</li>
</ul>
</li>
</ul>
<p>※本記事では、読者は「Azureのコンソール画面でのPrompt Flowの操作をしたことがある」という前提でご説明します。</p>
<h2 id="事前準備"><a href="#事前準備" class="headerlink" title="事前準備"></a>事前準備</h2><h3 id="1-Pythonのインストール"><a href="#1-Pythonのインストール" class="headerlink" title="1. Pythonのインストール"></a>1. Pythonのインストール</h3><p>Prompt Flowを動かすには、<code>Python 3.9</code>あるいは<code>Python 3.10</code>以上がインストールされている必要があります。</p>
<h3 id="2-Prompt-Flowライブラリのインストール"><a href="#2-Prompt-Flowライブラリのインストール" class="headerlink" title="2. Prompt Flowライブラリのインストール"></a>2. Prompt Flowライブラリのインストール</h3><p>以下のコマンドで<code>promptflow</code>,<code>promptflow-tools</code>のライブラリをインストールします</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pip install promptflow promptflow-tools</span><br></pre></td></tr></table></figure>

<p>インストールが完了したら以下のコマンドでpromptflowのバージョンが出力されます</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># (例) &quot;0.1.0b5&quot;</span></span><br><span class="line">pf -v </span><br></pre></td></tr></table></figure>

<h3 id="3-VSCode拡張機能をインストール"><a href="#3-VSCode拡張機能をインストール" class="headerlink" title="3. VSCode拡張機能をインストール"></a>3. VSCode拡張機能をインストール</h3><p>Prompt FlowのVSCode拡張機能をインストールします。</p>
<p>VSCodeの拡張機能にて「Prompt Flow」で検索すると出てきます。</p>
<img src="/images/20231011a/image.png" alt="Prompt Flow for VS Code" width="1200" height="560" loading="lazy">

<p>VSCode拡張機能が無くてもPrompt Flow自体は動かせますが、フローの可視化機能があるので、VSCodeが使用できる場合は入れておきましょう。</p>
<p>本記事ではVSCode拡張機能がインストールされている前提で説明していきます。</p>
<h2 id="シンプルな標準フローを作成する"><a href="#シンプルな標準フローを作成する" class="headerlink" title="シンプルな標準フローを作成する"></a>シンプルな標準フローを作成する</h2><p>以下のコマンドで、最もシンプルな標準フローが作成できます。<br><code>my-simple-flow</code>の部分はお好きなフロー名に変更してください。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pf flow init --flow my-simple-flow</span><br></pre></td></tr></table></figure>

<p>コマンドを実行したディレクトリの直下に<code>my-simple-flow</code>ディレクトリが自動生成されます。</p>
<p>中身は以下の通りです。</p>
<img src="/images/20231011a/image_2.png" alt="my-simple-flow, \pycache_, promptflow, flow.tools.json, .gitignore, data.jsonl, flow.dag.yaml, hello.jinja, hello.py, requirements.txt" width="432" height="330" loading="lazy">

<ul>
<li><code>__pycache__</code>: Pythonを実行する際に生成されるキャッシュディレクトリ（削除しても特に問題はない）</li>
<li><code>.promptflow/flow.tools.json</code>: flow.dag.yamlから参照されるToolsのメタデータ（修正する必要はない） </li>
<li><code>data.jsonl</code>: フローに入力するデータ</li>
<li><code>flow.dag.yaml</code>: 入出力・ノード・バリアント等を含むフローの全てを定義したファイル</li>
<li><code>.py, .jinja2等のファイル</code>: フロー内のツールが参照するコードスクリプト</li>
<li><code>requirements.txt</code>: フローの実行に必要なPythonパッケージのリスト</li>
</ul>
<p><code>flow.dag.yaml</code>ファイルの中身は以下の通りです。テキストベースなフロー定義データなので、直感では何をするフローか分かりにくいですね。</p>
<p>そこで赤枠の<code>Visual editor</code>を押してみます。</p>
<img src="/images/20231011a/コメント_2023-09-25_163948.png" alt="Visual editoor(Ctrl + k, v)" width="1156" height="1140" loading="lazy">

<p>すると、Azureコンソールでお馴染みのGUIベースの編集画面が出てきます。</p>
<p>「入力されたテキストをシステムプロンプトに含めて出力する」という、LLMを使わない簡単なフローのようです。</p>
<img src="/images/20231011a/pic.png" alt="" width="1200" height="612" loading="lazy">

<p>このVisual editorで編集した内容は、<code>flow.dag.yaml</code>のテキストデータに反映されるので、GUIベース及びテキストベースのどちらからでも編集可能です。</p>
<p>一度、フローを動かしてみます。</p>
<p>上図赤枠の部分に好きなテキスト（ここでは<code>Hello World!</code>）を入力し、<code>my-simple-flow</code>の親ディレクトリから以下のコマンドを打ちます。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pf flow <span class="built_in">test</span> --flow my-simple-flow</span><br></pre></td></tr></table></figure>

<p>すると、以下のようなコンソール出力が返ってきます。</p>
<img src="/images/20231011a/pic2.png" alt="output_prompt: Prompt: Write a simple Hello World! program that displays the greeting message when executed." width="1200" height="147" loading="lazy">

<p>「入力されたテキストをシステムプロンプトに含めて出力する」というシンプルな標準フローが実行できました。</p>
<h2 id="LLM付きの標準フローを作成する"><a href="#LLM付きの標準フローを作成する" class="headerlink" title="LLM付きの標準フローを作成する"></a>LLM付きの標準フローを作成する</h2><p>ここでは、入力された質問に対する応答をしてもらうフローを作っていきます。</p>
<p>前章で作成したフローの中にLLM（Prompt FlowではLLMツール&#x2F;LLMノードと呼ぶ）を追加し、少し複雑になったフローです。</p>
<h3 id="1-Connectionの設定"><a href="#1-Connectionの設定" class="headerlink" title="1. Connectionの設定"></a>1. Connectionの設定</h3><p>まずはConnection（接続）の設定を行います。</p>
<p>任意のディレクトリ上で、接続先を定義するYAMLファイルを作成します。（ここでは<code>connection-azure-openai.yaml</code>という名前で作成）</p>
<p>YAMLファイルの中身は<a target="_blank" rel="noopener" href="https://microsoft.github.io/promptflow/how-to-guides/manage-connections.html">公式Docs</a>を参考に以下のように作ります。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="string">$schema:</span> <span class="string">https://azuremlschemas.azureedge.net/promptflow/latest/AzureOpenAIConnection.schema.json</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">connection-azure-openai</span> <span class="comment"># 好きなコネクション名に設定可</span></span><br><span class="line"><span class="attr">type:</span> <span class="string">azure_open_ai</span></span><br><span class="line"><span class="attr">api_key:</span> <span class="string">&lt;API_KEY&gt;</span> <span class="comment"># Azure OpenAIリソースのAPIキー</span></span><br><span class="line"><span class="attr">api_base:</span> <span class="string">&lt;API_BASE&gt;</span> <span class="comment"># Azure OpenAIリソースのベース（エンドポイントURL）</span></span><br><span class="line"><span class="attr">api_type:</span> <span class="string">azure</span></span><br><span class="line"><span class="attr">api_version:</span> <span class="number">2023-07-01</span><span class="string">-preview</span> <span class="comment"># バージョンは変わる可能性あり</span></span><br></pre></td></tr></table></figure>

<p>YAMLファイルが作成できたら、以下のコマンドでconnectionを追加します。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pf connection create -f &lt;YAMLファイルのパス&gt;</span><br></pre></td></tr></table></figure>

<p>以下のように詳細が表示されればConnection（接続）の設定は完了です。</p>
<img src="/images/20231011a/pic3.png" alt="" width="1200" height="257" loading="lazy">

<h3 id="2-LLMツールの追加"><a href="#2-LLMツールの追加" class="headerlink" title="2. LLMツールの追加"></a>2. LLMツールの追加</h3><p>続いて、LLMツールを追加していきます。<code>flow.dag.yaml</code>のVisual editorの画面から「+LLM」を押します。</p>
<img src="/images/20231011a/pic4.png" alt="+LLM" width="1200" height="436" loading="lazy">


<p>上部に、LLMツールの名前入力が求められるので好きな名前を設定します。（ここでは<code>llm_node</code>と設定）</p>
<img src="/images/20231011a/image_3.png" alt="llm_node" width="889" height="97" loading="lazy">


<p>名前入力が完了すると、「new file」を選択します。（<code>&lt;LLMツール名&gt;.jinja2</code>というファイルが新規生成されます）</p>
<img src="/images/20231011a/image_4.png" alt="new file" width="885" height="131" loading="lazy">

<p>LLMツールが追加されました。connectionには先程設定した接続先が選択できるようになっています。</p>
<img src="/images/20231011a/pic5.png" alt="connection:connection-azure-openai api:chat deployment_name:***-gpt35-01 temperature:1 stop: max_tokens:" width="1200" height="266" loading="lazy">

<h3 id="3-フローの編集"><a href="#3-フローの編集" class="headerlink" title="3. フローの編集"></a>3. フローの編集</h3><p>入力された質問に対する応答をしてもらうフローを作っていきます。</p>
<p>Azureコンソールでは、1つの画面で全てのソースコードやプロンプトを直接編集できますが、ここではソースファイル毎に編集する必要があります。</p>
<p>フローの概略は以下の通りです。</p>
<p><code>Inputs</code>でユーザーからの質問を受け取り、<code>system_prompt</code>でシステムプロンプトにユーザーの質問を埋め込み、<code>llm_node</code>でLLMにプロンプトを投げ、<code>echo_llm_output</code>でLLMからの回答を加工して<code>output</code>に出力します。</p>
<img src="/images/20231011a/image_5.png" alt="inputs -> system_prompt -> llm_node -> echo_llm_output -> outputs" width="1200" height="1266" loading="lazy">

<details><summary>flow.dag.yaml</summary>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="attr">python_requirements_txt:</span> <span class="string">requirements.txt</span></span><br><span class="line"><span class="attr">inputs:</span></span><br><span class="line">  <span class="attr">question:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">    <span class="attr">default:</span> <span class="string">東京はどこの国の都市？</span></span><br><span class="line"><span class="attr">outputs:</span></span><br><span class="line">  <span class="attr">output:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">    <span class="attr">reference:</span> <span class="string">$&#123;echo_llm_output.output&#125;</span></span><br><span class="line"><span class="attr">nodes:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">system_prompt</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">prompt</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">system_prompt.jinja2</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">question:</span> <span class="string">$&#123;inputs.question&#125;</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">echo_llm_output</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">python</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">echo_llm_output.py</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">input:</span> <span class="string">$&#123;llm_node.output&#125;</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">llm_node</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">llm</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">llm_node.jinja2</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">input_prompt:</span> <span class="string">$&#123;system_prompt.output&#125;</span></span><br><span class="line">    <span class="attr">deployment_name:</span> <span class="string">gpt35-01</span></span><br><span class="line">    <span class="attr">max_tokens:</span> <span class="number">256</span></span><br><span class="line">  <span class="attr">connection:</span> <span class="string">connection-azure-openai</span></span><br><span class="line">  <span class="attr">api:</span> <span class="string">chat</span></span><br></pre></td></tr></table></figure>
</details>

<p>各ノードの詳細は以下の通りです。</p>
<h4 id="Inputs-Outputs"><a href="#Inputs-Outputs" class="headerlink" title="Inputs&amp;Outputs"></a>Inputs&amp;Outputs</h4><img src="/images/20231011a/image_6.png" alt="question string 東京はどこの国の都市？" width="1200" height="333" loading="lazy">


<h4 id="system-prompt"><a href="#system-prompt" class="headerlink" title="system_prompt"></a>system_prompt</h4><img src="/images/20231011a/image_7.png" alt="${inputs.question}" width="1200" height="222" loading="lazy">


<details><summary>system_prompt.jinja2</summary>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">system:</span><br><span class="line">あなたは優秀なAIチャットボットです。ユーザーからの質問に答えて下さい。</span><br><span class="line"></span><br><span class="line">user: </span><br><span class="line">&#123;&#123;question&#125;&#125; </span><br><span class="line"></span><br><span class="line">AI:</span><br></pre></td></tr></table></figure>
</details>

<h4 id="llm-node"><a href="#llm-node" class="headerlink" title="llm_node"></a>llm_node</h4><img src="/images/20231011a/pic6.png" alt="" width="1200" height="309" loading="lazy">

<details><summary>llm_node.jinja2</summary>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&#123;input_prompt&#125;&#125;</span><br></pre></td></tr></table></figure>
</details>

<h4 id="echo-llm-output"><a href="#echo-llm-output" class="headerlink" title="echo_llm_output"></a>echo_llm_output</h4><img src="/images/20231011a/image_8.png" alt="" width="1200" height="218" loading="lazy">


<details><summary>echo_llm_output.py</summary>

<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> promptflow <span class="keyword">import</span> tool</span><br><span class="line"></span><br><span class="line"><span class="meta">@tool</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">echo_llm_output</span>(<span class="params"><span class="built_in">input</span>: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;LLM出力: &quot;</span> + <span class="built_in">input</span></span><br></pre></td></tr></table></figure>
</details>


<h3 id="4-フローの実行"><a href="#4-フローの実行" class="headerlink" title="4. フローの実行"></a>4. フローの実行</h3><p>フローの編集が終わったら、先程と同様に以下のコマンドで実行します。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pf flow <span class="built_in">test</span> --flow my-simple-flow</span><br></pre></td></tr></table></figure>

<p>Outputsの欄に出力が表示されます。</p>
<img src="/images/20231011a/image_9.png" alt="" width="914" height="440" loading="lazy">


<h3 id="5-フローの一括実行"><a href="#5-フローの一括実行" class="headerlink" title="5. フローの一括実行"></a>5. フローの一括実行</h3><p>複数の入力を一括で実行することもできます。</p>
<p>まずは<code>flow.dag.yaml</code>ファイルを編集し、<code>default: 東京はどこの国の都市？</code>の行をコメントアウトします。</p>
<details><summary>flow.dag.yaml（コメントアウト後）</summary>

<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="attr">python_requirements_txt:</span> <span class="string">requirements.txt</span></span><br><span class="line"><span class="attr">inputs:</span></span><br><span class="line">  <span class="attr">question:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">    <span class="comment"># default: 東京はどこの国の都市？</span></span><br><span class="line"><span class="attr">outputs:</span></span><br><span class="line">  <span class="attr">output:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">string</span></span><br><span class="line">    <span class="attr">reference:</span> <span class="string">$&#123;echo_llm_output.output&#125;</span></span><br><span class="line"><span class="attr">nodes:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">system_prompt</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">prompt</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">system_prompt.jinja2</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">question:</span> <span class="string">$&#123;inputs.question&#125;</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">echo_llm_output</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">python</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">echo_llm_output.py</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">input:</span> <span class="string">$&#123;llm_node.output&#125;</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">llm_node</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">llm</span></span><br><span class="line">  <span class="attr">source:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">llm_node.jinja2</span></span><br><span class="line">  <span class="attr">inputs:</span></span><br><span class="line">    <span class="attr">input_prompt:</span> <span class="string">$&#123;system_prompt.output&#125;</span></span><br><span class="line">    <span class="attr">deployment_name:</span> <span class="string">gpt35-01</span></span><br><span class="line">    <span class="attr">max_tokens:</span> <span class="number">256</span></span><br><span class="line">  <span class="attr">connection:</span> <span class="string">connection-azure-openai</span></span><br><span class="line">  <span class="attr">api:</span> <span class="string">chat</span></span><br></pre></td></tr></table></figure>
</details>

<p>次に、フローのディレクトリ内にあった<code>data.jsonl</code>を編集し、以下のような内容を記載します。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;question&quot;</span><span class="punctuation">:</span> <span class="string">&quot;オーストラリアの首都は？&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;question&quot;</span><span class="punctuation">:</span> <span class="string">&quot;アメリカの首都は？&quot;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="attr">&quot;question&quot;</span><span class="punctuation">:</span> <span class="string">&quot;イギリスの首都は？&quot;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>1行が1つの入力に相当します。質問文を変えたり行を追加したりしても大丈夫です。</p>
<p>最後に、フローの親ディレクトリから以下のコマンドを実行します。（<code>my_run_001</code>の部分は任意）</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pf run create --flow my-simple-flow --data ./my-simple-flow/data.jsonl --name my_run_001</span><br></pre></td></tr></table></figure>

<p>以下のような出力が返ってくれば一括実行は成功です。</p>
<img src="/images/20231011a/7.png" alt="" width="1200" height="297" loading="lazy">


<p>複数実行の結果はログとして記録されており、以下のコマンドでいつでも可視化できます。</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">pf run show-details --name my_run_001</span><br></pre></td></tr></table></figure>

<img src="/images/20231011a/8.png" alt="" width="1007" height="312" loading="lazy">

<h2 id="作成したフローをコードで管理する"><a href="#作成したフローをコードで管理する" class="headerlink" title="作成したフローをコードで管理する"></a>作成したフローをコードで管理する</h2><p>今回作成したファイル群は以下の通りです。</p>
<img src="/images/20231011a/image_10.png" alt="" width="472" height="368" loading="lazy">


<p>これらはgitで管理することができます。</p>
<p>予め<code>.gitignore</code>ファイルが含まれているため、余計なキャッシュ等を含まずプッシュすることができますが、connection情報が入ったYAMLファイルは後で作成したファイルなので、プッシュしてしまう恐れがあります。</p>
<p>該当ファイルを<code>.gitignore</code>に追記するなどして、十分注意してください。</p>
<h2 id="まとめ"><a href="#まとめ" class="headerlink" title="まとめ"></a>まとめ</h2><p>本記事ではAzureのPrompt Flowをローカル環境で動かし、作成したフローをコードで管理する方法をご紹介しました。</p>
<p>LLMの開発や運用(LLMOps)に携わっている方々や、Prompt Flowを試している方々の参考となれば幸いです。</p>

          
        </div>
        <footer>
          <section class="social-area">
          <!-- シェアボタン START -->
  <ul class="social-button">
    
    <!-- Twitter -->
    <li>
      <a class="social-btn twitter-btn" target="_blank" href="https://twitter.com/intent/tweet?url=https://future-architect.github.io/articles/20231011a/&related=twitterapi%2Ctwitter&text=Prompt%20Flow%E3%82%92%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%EF%BC%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B%20%7C%20%E3%83%95%E3%83%A5%E3%83%BC%E3%83%81%E3%83%A3%E3%83%BC%E6%8A%80%E8%A1%93%E3%83%96%E3%83%AD%E3%82%B0" rel="nofollow noopener">
        <i></i><span class="social-btn-label">ツイート</span>
      </a>
    </li>
    <!-- Facebook -->
    <li>
      <a class="social-btn fb-btn" target="_blank" href="http://www.facebook.com/share.php?u=https://future-architect.github.io/articles/20231011a/&t=Prompt%20Flow%E3%82%92%E3%83%AD%E3%83%BC%E3%82%AB%E3%83%AB%E3%81%A7%E5%8B%95%E3%81%8B%E3%81%99%EF%BC%86%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B" rel="nofollow noopener">
        <i></i><span class="social-btn-label">シェア</span>
      </a>
    </li>
    <!-- hatebu -->
    <li>
      <a class="social-btn hatebu-btn" target="_blank" href="https://b.hatena.ne.jp/entry/s/future-architect.github.io/articles/20231011a/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">4</span>
      </a>
    </li>
    <!-- pocket -->
    <li>
      <a class="social-btn pocket-btn" target="_blank" href="https://getpocket.com/save?url=https://future-architect.github.io/articles/20231011a/" rel="nofollow noopener">
        <i></i><span class="social-btn-label">2</span>
      </a>
    </li>
    
  </ul>
<!-- シェアボタン END -->

          </section>
          <aside>
            <section class="related-post margin-bottom-40 nav">
              <h2 id="related"><a href="#related" class="headerlink" title="関連記事"></a>関連記事</h2>
              
  <div class="widget">
    <ul class="nav related-post-link"><li class="related-posts-item"><span>2023.09.19</span><span class="snscount">&#9825;28</span><a href=/articles/20230919a/ title="AzureのPrompt Flowを使ってLLMに入力するプロンプト評価の管理を行います。プロンプト評価の管理を行いたい背景として...">Prompt Flowでプロンプト評価の管理を行う</a></li><li class="related-posts-item"><span>2023.09.12</span><span class="snscount">&#9825;72</span><a href=/articles/20230912a/ title="昨今注目されている大規模言語モデルの開発においてMLOpsチームがやるべきことを考えるため、まずはLLM開発の流れを調査・整理しました。">LLM開発のフロー</a></li><li class="related-posts-item"><span>2024.04.01</span><span class="snscount">&#9825;0</span><a href=/articles/20240401a/ title="過去にいくつかEntraIDが、久々にMicrosoft 365 Developer Programにアクセスしたら、どこにEntraIDがあるのか場所が分からなかったのでメモです。">Microsoft 365 Developer ProgramでEntraID(旧名AzureAD)にアクセスする<span class="newitem">NEW</span></a></li><li class="related-posts-item"><span>2024.03.26</span><span class="snscount">&#9825;0</span><a href=/articles/20240326b/ title="言語処理学会第30回年次大会 に参加し、当社で取り組んだ研究内容についてポスター発表を行いました。言語処理学会は自然言語処理分野における国内最大の...">言語処理学会 (NLP2024) でポスター発表を行いました<span class="newitem">NEW</span></a></li><li class="related-posts-item"><span>2024.03.25</span><span class="snscount">&#9825;1</span><a href=/articles/20240325a/ title="昨今のOpenAI需要によって、Azure環境の利用を本格的に始める方も多いかと思います。今回はAzure環境でTerraformを利用する際、裏で動いているリソースプロバイダーについてご紹介します。">Azure環境Terraform実行におけるリソースプロバイダーについて<span class="newitem">NEW</span></a></li><li class="related-posts-item"><span>2023.09.14</span><span class="snscount">&#9825;2</span><a href=/articles/20230914a/ title="LLMの実験管理ツール候補として、TruLens-Evalを検証しました。合わせて、LLMの実験管理についてまとめてみました。">【LLMOps】LLMの実験管理にTruLens-Evalを使ってみた</a></li></ul>
  </div>
            </section>
            <section class="reference-post margin-bottom-40 nav">
              
            </section>
          </aside>
        </footer>
      </div>
    </article>
  </main>
  <aside class="col-md-3 blog-sidebar">
    <!-- START SIDEBAR  -->


<section class="toc-section">
  <h2 class="margin-top-30">目次</h2>
  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><span class="toc-text">はじめに</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%89%8D%E6%BA%96%E5%82%99"><span class="toc-text">事前準備</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Python%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><span class="toc-text">1. Pythonのインストール</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Prompt-Flow%E3%83%A9%E3%82%A4%E3%83%96%E3%83%A9%E3%83%AA%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><span class="toc-text">2. Prompt Flowライブラリのインストール</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-VSCode%E6%8B%A1%E5%BC%B5%E6%A9%9F%E8%83%BD%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><span class="toc-text">3. VSCode拡張機能をインストール</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%82%B7%E3%83%B3%E3%83%97%E3%83%AB%E3%81%AA%E6%A8%99%E6%BA%96%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><span class="toc-text">シンプルな標準フローを作成する</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#LLM%E4%BB%98%E3%81%8D%E3%81%AE%E6%A8%99%E6%BA%96%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E4%BD%9C%E6%88%90%E3%81%99%E3%82%8B"><span class="toc-text">LLM付きの標準フローを作成する</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Connection%E3%81%AE%E8%A8%AD%E5%AE%9A"><span class="toc-text">1. Connectionの設定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-LLM%E3%83%84%E3%83%BC%E3%83%AB%E3%81%AE%E8%BF%BD%E5%8A%A0"><span class="toc-text">2. LLMツールの追加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E3%83%95%E3%83%AD%E3%83%BC%E3%81%AE%E7%B7%A8%E9%9B%86"><span class="toc-text">3. フローの編集</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Inputs-Outputs"><span class="toc-text">Inputs&amp;Outputs</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#system-prompt"><span class="toc-text">system_prompt</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#llm-node"><span class="toc-text">llm_node</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#echo-llm-output"><span class="toc-text">echo_llm_output</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E3%83%95%E3%83%AD%E3%83%BC%E3%81%AE%E5%AE%9F%E8%A1%8C"><span class="toc-text">4. フローの実行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E3%83%95%E3%83%AD%E3%83%BC%E3%81%AE%E4%B8%80%E6%8B%AC%E5%AE%9F%E8%A1%8C"><span class="toc-text">5. フローの一括実行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E6%88%90%E3%81%97%E3%81%9F%E3%83%95%E3%83%AD%E3%83%BC%E3%82%92%E3%82%B3%E3%83%BC%E3%83%89%E3%81%A7%E7%AE%A1%E7%90%86%E3%81%99%E3%82%8B"><span class="toc-text">作成したフローをコードで管理する</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E3%81%BE%E3%81%A8%E3%82%81"><span class="toc-text">まとめ</span></a></li></ol>
</section>

<section class="category">
<h2 class="margin-top-30">カテゴリー</h2>
<div class="widget">
  <ul class="nav sidebar-categories margin-bottom-40">
  
  <li class=""><a href="/categories/Programming/">Programming (449)</a></li>
<li class=""><a href="/categories/Infrastructure/">Infrastructure (268)</a></li>
<li class=""><a href="/categories/Culture/">Culture (100)</a></li>
<li class=""><a href="/categories/DataScience/">DataScience (62)</a></li>
<li class=""><a href="/categories/IoT/">IoT (35)</a></li>
<li class=""><a href="/categories/DB/">DB (25)</a></li>
<li class=""><a href="/categories/DevOps/">DevOps (23)</a></li>
<li class=""><a href="/categories/%E8%AA%8D%E8%A8%BC%E8%AA%8D%E5%8F%AF/">認証認可 (21)</a></li>
<li class=""><a href="/categories/Business/">Business (21)</a></li>
<li class=""><a href="/categories/Management/">Management (17)</a></li>
<li class=""><a href="/categories/Security/">Security (15)</a></li>
<li class=""><a href="/categories/VR/">VR (13)</a></li>
<li class=""><a href="/categories/Design/">Design (11)</a></li>

  </ul>
</div>

</section>
<section class="podcast-link">
<h2 class="margin-top-30">Tech Cast</h2>

  <div class="class="widget-wrap">
  <div class="widget">
    <ul class="nav techcast">
      
    </ul>
  </div>
  </div>
  
</section>
<section class="advent-calendar">
<h2 class="margin-top-30">アドベントカレンダー</h2>
<div class="widget">
  <ul class="nav-flex">
    <li><a href="http://qiita.com/advent-calendar/2023/future" title="フューチャー Advent Calendar 2023 #Qiita" target="_blank" rel="noopener">2023年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2022/future" title="フューチャー Advent Calendar 2022 #Qiita" target="_blank" rel="noopener">2022年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2021/future" title="フューチャー Advent Calendar 2021 #Qiita" target="_blank" rel="noopener">2021年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2020/future" title="フューチャー Advent Calendar 2020 #Qiita" target="_blank" rel="noopener">2020年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2019/future" title="フューチャー Advent Calendar 2019 #Qiita" target="_blank" rel="noopener">2019年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2018/future" title="フューチャー Advent Calendar 2018 #Qiita" target="_blank" rel="noopener">2018年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2017/future" title="フューチャー Advent Calendar 2017 #Qiita" target="_blank" rel="noopener">2017年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2016/future" title="フューチャー Advent Calendar 2016 #Qiita" target="_blank" rel="noopener">2016年</a></li>
    <li><a href="http://qiita.com/advent-calendar/2015/future" title="フューチャー Advent Calendar 2015 #Qiita" target="_blank" rel="noopener">2015年</a></li>
  </ul>
</div>

</section>
<!-- END SIDEBAR -->

  </aside>
</div>

  </section>
</div>

      <!-- BEGIN PRE-FOOTER -->
    <footer>
      <div class="pre-footer">
        <div class="container">
          <div class="row">
            <div class="col-lg-4 col-md-4 col-sm-6 col-6 pre-footer-col">
              <h2>About Us</h2>
              <p>経営とITをデザインする、フューチャーの技術ブログです。業務で利用している幅広い技術について紹介します。<br /><br /><a target="_blank" rel="noopener" href="http://www.future.co.jp/">http://www.future.co.jp/</a></p>
              <div class="social-btn twitter-btn twitter-follow-btn">
                <a href="https://twitter.com/intent/follow?screen_name=future_techblog " target="_blank" rel="nofollow noopener">
                  <i></i><span class="tw-btn-label">フューチャー技術ブログをフォロー</span>
                </a>
              </div>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-4 col-4 pre-footer-col">
              <h2>Contact</h2>
              <address class="margin-bottom-40">
                <a href="https://www.future.co.jp/recruit/recruit/rec-fresh/" title="新卒採用" target="_blank" rel="noopener">新卒採用</a><br>
                <a href="https://www.future.co.jp/recruit/recruit/rec-career/" title="キャリア採用" target="_blank" rel="noopener">キャリア採用</a><br>
                <a href="https://www.future.co.jp/contact_us/" title="お問い合わせページ" target="_blank" rel="noopener">お問い合わせ</a><br>
                <a href="https://www.future.co.jp/architect/socialmediapolicy/" title="ソーシャルメディアポリシー" target="_blank" rel="noopener">メディアポリシー</a><br><br>
                <a href="mailto:techblog@future.co.jp">techblog@future.co.jp</a>
              </address>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-6 col-6 pre-footer-col">
              <h2>Contents</h2>
              <a href="https://future-architect.github.io/coding-standards/" title="Future Enterprise Coding Standards" target="_blank" rel="noopener">コーディング規約</a><br>
              <a href="https://future-architect.github.io/typescript-guide/" title="仕事ですぐに使えるTypeScript" target="_blank" rel="noopener">仕事ですぐに使えるTypeScript</a><br>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-3 col-3 pre-footer-col">
              <h2>Event</h2>
              <a href="https://future.connpass.com/" title="経営とITをデザインするフューチャーの勉強会です" target="_blank" rel="noopener">connpass</a><br>
              <a href="https://www.future.co.jp/futureinsightseminar/" title="フューチャーインサイトセミナー" target="_blank" rel="noopener">Webセミナー</a><br>
            </div>
            <div class="col-lg-2 col-md-4 col-sm-3 col-3 pre-footer-col">
              <h2>SNS</h2>
              <a href="https://github.com/future-architect" title="Future's official open source repositories" target="_blank" rel="noopener">GitHub</a><br>
              <a href="https://qiita.com/organizations/future" title="フューチャーのQiita Organizationです" target="_blank" rel="noopener">Qiita</a><br>
              <a href="https://note.future.co.jp/" title="フューチャーの公式note" target="_blank" rel="noopener">未来報</a><br>
              <a href="https://www.youtube.com/channel/UCJUSwYYd0CkGgmEKAW7QVpw" title="フューチャーYoutubeチャネル" target="_blank" rel="noopener">Youtube</a>
            </div>
          </div>
        </div>
      </div>
      <div class="footer">
        <div class="container">
          <div class="row">
            <div class="col-md-6 col-sm-6 padding-top-10">
              &copy; 2024 フューチャー技術ブログ<br>
            </div>
          </div>
        </div>
      </div>
    </footer>

  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X1C28R8H0M"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-X1C28R8H0M');
  gtag('config', 'UA-74047147-1'); // 過渡期対応
</script>

  </div>
</body>
</html>
