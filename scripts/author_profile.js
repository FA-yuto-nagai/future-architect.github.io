'use strict';

const loadYamlFile = filename => {
  const fs = require('fs');
  const yaml = require('js-yaml');
  const yamlText = fs.readFileSync(filename, 'utf8')
  return yaml.load(yamlText);
}

const profile = loadYamlFile('./_profile.yml');


hexo.extend.helper.register("get_profile", authorName => {
  const authorProfile = profile[authorName];
  if (!authorProfile) {
    return ""
  }

  let result = `<p>${authorProfile.about}</p>`;
  if (authorProfile.twitter_id) {
    result += `<a target="_blank" href="https://twitter.com/${authorProfile.twitter_id}" rel="nofollow noopener"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzIgMzIiPjxwYXRoIGZpbGw9IiMxREExRjIiIGQ9Ik0zMiA3LjA3NWMtMS4xNzUgMC41MjUtMi40NDQgMC44NzUtMy43NjkgMS4wMzEgMS4zNTYtMC44MTMgMi4zOTQtMi4xIDIuODg3LTMuNjMxLTEuMjY5IDAuNzUtMi42NzUgMS4zLTQuMTY5IDEuNTk0LTEuMi0xLjI3NS0yLjkwNi0yLjA2OS00Ljc5NC0yLjA2OS0zLjYyNSAwLTYuNTYzIDIuOTM4LTYuNTYzIDYuNTYzIDAgMC41MTIgMC4wNTYgMS4wMTIgMC4xNjkgMS40OTQtNS40NTYtMC4yNzUtMTAuMjk0LTIuODg4LTEzLjUzMS02Ljg2Mi0wLjU2MyAwLjk2OS0wLjg4NyAyLjEtMC44ODcgMy4zIDAgMi4yNzUgMS4xNTYgNC4yODcgMi45MTkgNS40NjMtMS4wNzUtMC4wMzEtMi4wODctMC4zMzEtMi45NzUtMC44MTkgMCAwLjAyNSAwIDAuMDU2IDAgMC4wODEgMCAzLjE4MSAyLjI2MyA1LjgzOCA1LjI2OSA2LjQzNy0wLjU1IDAuMTUtMS4xMzEgMC4yMzEtMS43MzEgMC4yMzEtMC40MjUgMC0wLjgzMS0wLjA0NC0xLjIzNy0wLjExOSAwLjgzOCAyLjYwNiAzLjI2MyA0LjUwNiA2LjEzMSA0LjU2My0yLjI1IDEuNzYyLTUuMDc1IDIuODEzLTguMTU2IDIuODEzLTAuNTMxIDAtMS4wNTAtMC4wMzEtMS41NjktMC4wOTQgMi45MTMgMS44NjkgNi4zNjIgMi45NSAxMC4wNjkgMi45NSAxMi4wNzUgMCAxOC42ODEtMTAuMDA2IDE4LjY4MS0xOC42ODEgMC0wLjI4Ny0wLjAwNi0wLjU2OS0wLjAxOS0wLjg1IDEuMjgxLTAuOTE5IDIuMzk0LTIuMDc1IDMuMjc1LTMuMzk0eiI+PC9wYXRoPjwvc3ZnPg==" alt="Twitter" class="author-icon"></a>`
  }
  if (authorProfile.github_id) {
    result += `<a target="_blank" href="https://github.com/${authorProfile.github_id}" rel="nofollow noopener"><img src="data:image/svg+xml;base64,PHN2ZyBhcmlhLWhpZGRlbj0idHJ1ZSIgZm9jdXNhYmxlPSJmYWxzZSIgZGF0YS1wcmVmaXg9ImZhYiIgZGF0YS1pY29uPSJnaXRodWIiIGNsYXNzPSJzdmctaW5saW5lLS1mYSBmYS1naXRodWIgZmEtdy0xNiIgcm9sZT0iaW1nIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OTYgNTEyIj48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0xNjUuOSAzOTcuNGMwIDItMi4zIDMuNi01LjIgMy42LTMuMy4zLTUuNi0xLjMtNS42LTMuNiAwLTIgMi4zLTMuNiA1LjItMy42IDMtLjMgNS42IDEuMyA1LjYgMy42em0tMzEuMS00LjVjLS43IDIgMS4zIDQuMyA0LjMgNC45IDIuNiAxIDUuNiAwIDYuMi0ycy0xLjMtNC4zLTQuMy01LjJjLTIuNi0uNy01LjUuMy02LjIgMi4zem00NC4yLTEuN2MtMi45LjctNC45IDIuNi00LjYgNC45LjMgMiAyLjkgMy4zIDUuOSAyLjYgMi45LS43IDQuOS0yLjYgNC42LTQuNi0uMy0xLjktMy0zLjItNS45LTIuOXpNMjQ0LjggOEMxMDYuMSA4IDAgMTEzLjMgMCAyNTJjMCAxMTAuOSA2OS44IDIwNS44IDE2OS41IDIzOS4yIDEyLjggMi4zIDE3LjMtNS42IDE3LjMtMTIuMSAwLTYuMi0uMy00MC40LS4zLTYxLjQgMCAwLTcwIDE1LTg0LjctMjkuOCAwIDAtMTEuNC0yOS4xLTI3LjgtMzYuNiAwIDAtMjIuOS0xNS43IDEuNi0xNS40IDAgMCAyNC45IDIgMzguNiAyNS44IDIxLjkgMzguNiA1OC42IDI3LjUgNzIuOSAyMC45IDIuMy0xNiA4LjgtMjcuMSAxNi0zMy43LTU1LjktNi4yLTExMi4zLTE0LjMtMTEyLjMtMTEwLjUgMC0yNy41IDcuNi00MS4zIDIzLjYtNTguOS0yLjYtNi41LTExLjEtMzMuMyAyLjYtNjcuOSAyMC45LTYuNSA2OSAyNyA2OSAyNyAyMC01LjYgNDEuNS04LjUgNjIuOC04LjVzNDIuOCAyLjkgNjIuOCA4LjVjMCAwIDQ4LjEtMzMuNiA2OS0yNyAxMy43IDM0LjcgNS4yIDYxLjQgMi42IDY3LjkgMTYgMTcuNyAyNS44IDMxLjUgMjUuOCA1OC45IDAgOTYuNS01OC45IDEwNC4yLTExNC44IDExMC41IDkuMiA3LjkgMTcgMjIuOSAxNyA0Ni40IDAgMzMuNy0uMyA3NS40LS4zIDgzLjYgMCA2LjUgNC42IDE0LjQgMTcuMyAxMi4xQzQyOC4yIDQ1Ny44IDQ5NiAzNjIuOSA0OTYgMjUyIDQ5NiAxMTMuMyAzODMuNSA4IDI0NC44IDh6TTk3LjIgMzUyLjljLTEuMyAxLTEgMy4zLjcgNS4yIDEuNiAxLjYgMy45IDIuMyA1LjIgMSAxLjMtMSAxLTMuMy0uNy01LjItMS42LTEuNi0zLjktMi4zLTUuMi0xem0tMTAuOC04LjFjLS43IDEuMy4zIDIuOSAyLjMgMy45IDEuNiAxIDMuNi43IDQuMy0uNy43LTEuMy0uMy0yLjktMi4zLTMuOS0yLS42LTMuNi0uMy00LjMuN3ptMzIuNCAzNS42Yy0xLjYgMS4zLTEgNC4zIDEuMyA2LjIgMi4zIDIuMyA1LjIgMi42IDYuNSAxIDEuMy0xLjMuNy00LjMtMS4zLTYuMi0yLjItMi4zLTUuMi0yLjYtNi41LTF6bS0xMS40LTE0LjdjLTEuNiAxLTEuNiAzLjYgMCA1LjkgMS42IDIuMyA0LjMgMy4zIDUuNiAyLjMgMS42LTEuMyAxLjYtMy45IDAtNi4yLTEuNC0yLjMtNC0zLjMtNS42LTJ6Ij48L3BhdGg+PC9zdmc+" alt="Twitter" class="author-icon"></a>`
  }
  return `<div class="author-profile">${result}</div>`;
})
